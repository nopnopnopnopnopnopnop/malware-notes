

### PE header
----
- Contains the information the OS requires in order to run the binary
- Can give us insight into how the malware functions
- Contains what DLL's is it importing, great for us
- Contains where the execution begins
- Where it needs to be loaded in memory
- And much more

##### PE header structure
| Header                | Description                                                                  |
| --------------------- | ---------------------------------------------------------------------------- |
| MZ/DOS header         | Defines the file as a binary executable                                      |
| DOS Stub              | Classic message, meant for compatibility                                     |
| PE file header        | Defines the exe as a PE                                                      |
| Image optional header | Stores important information about the executable : subsystem,entry point,.. |
| Sections Table        | Instructions on how to load the exe into memory                              |
| Sections              | Exe sections of code and data used by the exe                                |





### PE Sections
---

| **Section** | **Description**                                                              |
| ----------- | ---------------------------------------------------------------------------- |
| .text       | Contains the executable code                                                 |
| .rdata      | Holds read-only data that is globally accessible within the program          |
| .data       | Stores global data accessed throughout the program                           |
| .idata      | If present, contains import data. If not present, stored in .rdata           |
| .edata      | If present, contains export data. If not present, stored in .rdata           |
| .pdata      | Present only in 64-bit executables and stores exception-handling information |
| .rsrc       | Stores resources needed by the executable                                    |
| .reloc      | Contains information for relocation of library files                         |

### PE analysis
---
**What we want to know?** :
1) Compiler stats
2) Subsystem
3) Sections - is it packed? (easier way is to use PeID).. still useful if you are insane (malware analyst)
4) Libraries and imports 



#### .rsrc analysis
---
- Since it stores resources that the executable needs, it's a good to analyze it. It can contain a lot - more malicious file, droppers, conf. info, payloads, origin of the malware,...
- For this task, I am using a sample from HackerSploit : 
- `hxxps://s3.eu-central-1.amazonaws.com/dasmalwerk/downloads/5ed2f09e648dca8f0ca75466b1442f6e599afddc80777e0559fb6881c6cd9ff3/5ed2f09e648dca8f0ca75466b1442f6e599afddc80777e0559fb6881c6cd9ff3.zip&v=r9BENeAGGJY`

##### Steps: 
1) Checking if the malicious file is packed (peid) : 
- 

